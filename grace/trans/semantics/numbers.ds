module trans/semantics/numbers

imports
  src-gen/ds-signatures/grace-lowered-sig
  trans/semantics/expressions
  trans/semantics/values
  trans/semantics/runtime/natives
  trans/semantics/booleans

signature
  constructors
    NumV : Int -> V
  
rules
  
  NumL(s) --> Number(s).
  
  Number(a) --> NumV(string2int(a)).
  
  MCallRecvL(NumV(a), "==", [NumV(b)]) --> BoolV(true)
    where
      a == b.
  
  MCallRecvL(NumV(a), "==", [NumV(b)]) --> BoolV(false)
    where
      a != b.
      
  MCallRecvL(NumV(a), "!=", [NumV(b)]) --> BoolV(false)
    where
      a == b.
      
  MCallRecvL(NumV(a), "!=", [NumV(b)]) --> BoolV(true)
    where
      a != b.
  
  MCallRecvL(NumV(a), op, [NumV(b)]) -->
      NumV(nativeIBinOp(op, a, b)).
        
    